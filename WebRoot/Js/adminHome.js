function exiting(){var n=Sys.WebForms.PageRequestManager.getInstance();n.abortPostBack()}function gotStats(n){n=eval(n),$("#statis").text(n[0]),$("#spaceUsage").text(n[1])}function reTry(){$("#checking").text("正在联系服务器 ……"),$("#btnTrigger").click()}function preUpdate(){return confirm("警告：\n1. 仅应对官方发行的标准版本应用更新，否则将丢失定制修改的特性；\n2. 建议更新前先备份系统；\n3. 更新后客户端浏览器须清空缓存（临时文件）。\n\n是否继续？")?($("#ddlVers").prop("disabled",!0),$("#btnUpgrade").hide(),showStatus("正在准备 …"),!0):!1}function showStatus(n){$("#progress").show().text(n)}function getUpgradeStatus(){$("#ddlVers").prop("disabled",!0),$("#btnUpgrade").hide(),$.get("ajax.aspx",{action:"getDownloadStatus"},function(n){switch(n){case"-2":case"0":showStatus("正在准备 …"),setTimeout(function(){getUpgradeStatus()},2e3);break;case"-1":resetStatus(),alert("获取更新包失败！");break;case"1":showStatus("正在执行更新 …"),PageMethods.doUpgrade(null,Upgrade_Callback);break;default:showStatus("已下载 "+n+" …"),setTimeout(function(){getUpgradeStatus()},2e3)}})}function resetStatus(){$("#ddlVers").prop("disabled",!1),$("#btnUpgrade").show(),$("#progress").hide()}function Upgrade_Callback(n){n=eval(n),resetStatus(),$("#loading").hide(),n[0].toLowerCase()=="true"?(winalert(n[1]+"现在将重新打开系统。"),parent.location.reload(!0)):alert("更新失败："+n[1])}function upload(){var n=$("#toUpload").val(),t=new RegExp("\\.(zip)$","i");return t.test(n)?confirm("警告：\n1. 仅应对官方发行的标准版本应用更新，否则将丢失定制修改的特性；\n2. 建议更新前先备份系统；\n3. 更新后客户端浏览器须清空缓存（临时文件）。\n\n确定要使用该更新包更新系统吗？")?($(document).ajaxStart(showLoading).ajaxComplete(hideLoading),$.ajaxFileUpload({url:"ajax.aspx?action=upload",secureuri:!1,fileElementId:"toUpload",dataType:"json",success:function(n){if(typeof n.error!="undefined"&&n.error!="")alert(n.error);else{var t=n.files,i=null;typeof t!="undefined"&&t!=null&&t.length>0&&(i=t[0]),i==null?alert("文件上传错误！"):PageMethods.doUpgrade(i,Upgrade_Callback)}},error:function(n,t,i){hideLoading(),alert(i.name+":"+i.description)}}),!1):!1:(alert("无效的文件！"),!1)}var defTab=0;$(function(){$("#tabs").tabs({active:defTab}).fadeIn(300),PageMethods.getStatis(gotStats),$("#btnTrigger").click(),MakeEditor("textarea.ck","Normal",220,!1,!1),$(".item img").mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")});var n=Sys.WebForms.PageRequestManager.getInstance();n.add_initializeRequest(showLoading),n.add_endRequest(hideLoading)})